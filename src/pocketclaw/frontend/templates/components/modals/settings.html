<!--
  PocketPaw Dashboard - Settings Modal

  Changes (2026-02-03):
  - Extracted from monolithic index.html
  - Contains: Agent Backend, LLM Provider, Anthropic Model selection
  - Permission bypass toggle, API key inputs
-->
<!-- Settings Modal -->
<div
class="fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-md p-4"
x-show="showSettings"
x-transition.opacity
@click.self="showSettings = false"
>
<div class="w-full max-w-[600px] bg-[#1c1c1e]/95 backdrop-blur-xl border border-[var(--glass-border)] rounded-[20px] shadow-2xl animate-[modalPop_0.25s_ease-out] overflow-hidden" @click.stop>
    <div class="flex items-center justify-between px-6 py-5 border-b border-[var(--glass-border)]">
    <h2 class="text-[17px] font-semibold">Settings</h2>
    <button class="p-2 -mr-2 text-[var(--text-secondary)] hover:text-white hover:bg-white/10 rounded-lg transition-colors" @click="showSettings = false">
        <i data-lucide="x" class="w-5 h-5"></i>
    </button>
    </div>
    
    <div class="p-6 space-y-5 max-h-[70vh] overflow-y-auto">
    <!-- Form Group: Agent Backend -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">Agent Backend</label>
        <div class="relative">
        <select 
            x-model="settings.agentBackend" 
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <option value="claude_agent_sdk">Claude Agent SDK (Recommended)</option>
        <option value="pocketpaw_native">PocketPaw Native</option>
        <option value="open_interpreter">Open Interpreter</option>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
        <small class="text-white/40 text-xs" x-text="getBackendDescription(settings.agentBackend)"></small>
    </div>

    <!-- Form Group: LLM Provider -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">LLM Provider</label>
        <div class="relative">
        <select 
            x-model="settings.llmProvider" 
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <option value="auto">Auto</option>
        <option value="anthropic">Anthropic</option>
        <option value="openai">OpenAI</option>
        <option value="ollama">Ollama</option>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
    </div>

    <!-- Form Group: Anthropic Model -->
    <div class="flex flex-col gap-2" x-show="settings.llmProvider === 'anthropic' || settings.llmProvider === 'auto'">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">Anthropic Model</label>
        <div class="relative">
        <select 
            x-model="settings.anthropicModel" 
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <optgroup label="Claude 4.5 (Latest)">
            <option value="claude-sonnet-4-5-20250929">Claude Sonnet 4.5 (Recommended)</option>
            <option value="claude-opus-4-5-20250929">Claude Opus 4.5</option>
            <option value="claude-haiku-4-5-20250929">Claude Haiku 4.5</option>
        </optgroup>
        <optgroup label="Claude 4">
            <option value="claude-sonnet-4-20250514">Claude Sonnet 4</option>
            <option value="claude-opus-4-20250514">Claude Opus 4</option>
        </optgroup>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
    </div>

    <!-- Form Group: Permission Bypass -->
    <div class="flex flex-col gap-2">
        <label class="flex items-start gap-3 cursor-pointer group">
        <input type="checkbox" x-model="settings.bypassPermissions" @change="saveSettings()" class="mt-0.5 accent-[var(--accent-color)] w-4 h-4">
        <div class="flex flex-col">
            <span class="text-[14px] font-medium group-hover:text-white transition-colors">Bypass Permission Prompts</span>
            <span class="text-xs text-[var(--warning-color)] mt-0.5">⚠️ Agent will execute actions without asking for approval. Use with caution.</span>
        </div>
        </label>
    </div>

    <!-- Injection Scanner -->
    <div class="flex flex-col gap-2">
        <label class="flex items-start gap-3 cursor-pointer group">
        <input type="checkbox" x-model="settings.injectionScanEnabled" @change="saveSettings()" class="mt-0.5 accent-[var(--accent-color)] w-4 h-4">
        <div class="flex flex-col">
            <span class="text-[14px] font-medium group-hover:text-white transition-colors">Injection Scanner</span>
            <span class="text-xs text-white/40 mt-0.5">Scan inbound messages for prompt injection attacks</span>
        </div>
        </label>
    </div>

    <!-- LLM Deep Scan (shown when injection scan enabled) -->
    <div class="flex flex-col gap-2 pl-7" x-show="settings.injectionScanEnabled" x-transition>
        <label class="flex items-start gap-3 cursor-pointer group">
        <input type="checkbox" x-model="settings.injectionScanLlm" @change="saveSettings()" class="mt-0.5 accent-[var(--accent-color)] w-4 h-4">
        <div class="flex flex-col">
            <span class="text-[14px] font-medium group-hover:text-white transition-colors">LLM Deep Scan</span>
            <span class="text-xs text-white/40 mt-0.5">Use a secondary LLM to analyze suspicious content (requires API key)</span>
        </div>
        </label>
    </div>

    <hr class="border-t border-[var(--glass-border)] opacity-50" />

    <h3 class="text-[14px] font-semibold text-[var(--text-secondary)]">Agent Behavior</h3>

    <!-- Tool Profile -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">Tool Profile</label>
        <div class="relative">
        <select
            x-model="settings.toolProfile"
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <option value="full">Full (No restrictions)</option>
        <option value="coding">Coding (Filesystem + Shell + Memory)</option>
        <option value="minimal">Minimal (Memory only)</option>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
    </div>

    <!-- Plan Mode -->
    <div class="flex flex-col gap-2">
        <label class="flex items-start gap-3 cursor-pointer group">
        <input type="checkbox" x-model="settings.planMode" @change="saveSettings()" class="mt-0.5 accent-[var(--accent-color)] w-4 h-4">
        <div class="flex flex-col">
            <span class="text-[14px] font-medium group-hover:text-white transition-colors">Plan Mode</span>
            <span class="text-xs text-white/40 mt-0.5">Require approval before executing tools</span>
        </div>
        </label>
    </div>

    <!-- Plan Mode Tools (shown when plan mode on) -->
    <div class="flex flex-col gap-2 pl-7" x-show="settings.planMode" x-transition>
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">Plan Mode Tools</label>
        <input
            type="text"
            x-model="settings.planModeTools"
            @change="saveSettings()"
            placeholder="shell,write_file,edit_file"
            class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <small class="text-white/40 text-xs">Comma-separated list of tools that require approval</small>
    </div>

    <!-- Smart Model Routing -->
    <div class="flex flex-col gap-2">
        <label class="flex items-start gap-3 cursor-pointer group">
        <input type="checkbox" x-model="settings.smartRoutingEnabled" @change="saveSettings()" class="mt-0.5 accent-[var(--accent-color)] w-4 h-4">
        <div class="flex flex-col">
            <span class="text-[14px] font-medium group-hover:text-white transition-colors">Smart Model Routing</span>
            <span class="text-xs text-white/40 mt-0.5">Automatically select model based on task complexity</span>
        </div>
        </label>
    </div>

    <!-- Model Tiers (shown when routing on) -->
    <div class="flex flex-col gap-3 pl-7" x-show="settings.smartRoutingEnabled" x-transition>
        <div class="flex flex-col gap-1">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Simple Tier</label>
            <input
                type="text"
                x-model="settings.modelTierSimple"
                @change="saveSettings()"
                class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
            />
        </div>
        <div class="flex flex-col gap-1">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Moderate Tier</label>
            <input
                type="text"
                x-model="settings.modelTierModerate"
                @change="saveSettings()"
                class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
            />
        </div>
        <div class="flex flex-col gap-1">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Complex Tier</label>
            <input
                type="text"
                x-model="settings.modelTierComplex"
                @change="saveSettings()"
                class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
            />
        </div>
    </div>

    <hr class="border-t border-[var(--glass-border)] opacity-50" />

    <h3 class="text-[14px] font-semibold text-[var(--text-secondary)]">Memory Backend</h3>

    <!-- Memory Backend Selector -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">Backend</label>
        <div class="relative">
        <select
            x-model="settings.memoryBackend"
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <option value="file">File (Simple Markdown)</option>
        <option value="mem0">Mem0 (Semantic Search + LLM)</option>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
        <small class="text-white/40 text-xs" x-text="settings.memoryBackend === 'mem0' ? 'Uses LLM to extract and evolve facts. Requires mem0ai package.' : 'Simple append-only markdown files. No dependencies needed.'"></small>
    </div>

    <!-- Mem0 Options (shown when mem0 selected) -->
    <div x-show="settings.memoryBackend === 'mem0'" x-transition class="flex flex-col gap-4 pl-2 border-l-2 border-[var(--accent-color)]/30 ml-1">

        <!-- Auto-Learn -->
        <div class="flex flex-col gap-2">
            <label class="flex items-start gap-3 cursor-pointer group">
            <input type="checkbox" x-model="settings.mem0AutoLearn" @change="saveSettings()" class="mt-0.5 accent-[var(--accent-color)] w-4 h-4">
            <div class="flex flex-col">
                <span class="text-[14px] font-medium group-hover:text-white transition-colors">Auto-Learn</span>
                <span class="text-xs text-white/40 mt-0.5">Automatically extract facts from every conversation</span>
            </div>
            </label>
        </div>

        <!-- LLM Provider for Mem0 -->
        <div class="flex flex-col gap-2">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Mem0 LLM Provider</label>
            <div class="relative">
            <select
                x-model="settings.mem0LlmProvider"
                @change="saveSettings()"
                class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
            >
            <option value="anthropic">Anthropic</option>
            <option value="openai">OpenAI</option>
            <option value="ollama">Ollama (Local)</option>
            </select>
            <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
                <i data-lucide="chevron-down" class="w-4 h-4"></i>
            </div>
            </div>
            <small class="text-white/40 text-xs">LLM used for fact extraction and memory consolidation</small>
        </div>

        <!-- LLM Model -->
        <div class="flex flex-col gap-2">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Mem0 LLM Model</label>
            <input
                type="text"
                x-model="settings.mem0LlmModel"
                @change="saveSettings()"
                placeholder="claude-haiku-4-5-20251001"
                class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
            />
        </div>

        <!-- Embedder Provider -->
        <div class="flex flex-col gap-2">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Embedder Provider</label>
            <div class="relative">
            <select
                x-model="settings.mem0EmbedderProvider"
                @change="saveSettings()"
                class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
            >
            <option value="openai">OpenAI</option>
            <option value="ollama">Ollama (Local)</option>
            <option value="huggingface">HuggingFace</option>
            </select>
            <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
                <i data-lucide="chevron-down" class="w-4 h-4"></i>
            </div>
            </div>
        </div>

        <!-- Embedder Model -->
        <div class="flex flex-col gap-2">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Embedder Model</label>
            <input
                type="text"
                x-model="settings.mem0EmbedderModel"
                @change="saveSettings()"
                placeholder="text-embedding-3-small"
                class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
            />
        </div>

        <!-- Vector Store -->
        <div class="flex flex-col gap-2">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Vector Store</label>
            <div class="relative">
            <select
                x-model="settings.mem0VectorStore"
                @change="saveSettings()"
                class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
            >
            <option value="qdrant">Qdrant (Default)</option>
            <option value="chroma">ChromaDB</option>
            </select>
            <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
                <i data-lucide="chevron-down" class="w-4 h-4"></i>
            </div>
            </div>
        </div>

        <!-- Ollama Base URL (shown when ollama is selected for LLM or embedder) -->
        <div class="flex flex-col gap-2" x-show="settings.mem0LlmProvider === 'ollama' || settings.mem0EmbedderProvider === 'ollama'" x-transition>
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Ollama Base URL</label>
            <input
                type="text"
                x-model="settings.mem0OllamaBaseUrl"
                @change="saveSettings()"
                placeholder="http://localhost:11434"
                class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
            />
        </div>
    </div>

    <hr class="border-t border-[var(--glass-border)] opacity-50" />

    <h3 class="text-[14px] font-semibold text-[var(--text-secondary)]">API Keys</h3>
    
    <!-- API Key Input -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Anthropic API Key</label>
            <span x-show="hasAnthropicKey" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.anthropic"
            :placeholder="hasAnthropicKey ? '••••••••••••••••' : 'sk-ant-...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button 
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95" 
            @click="saveApiKey('anthropic')"
        >
            Save
        </button>
        </div>
    </div>

    <!-- OpenAI API Key Input -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">OpenAI API Key</label>
            <span x-show="hasOpenaiKey" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.openai"
            :placeholder="hasOpenaiKey ? '••••••••••••••••' : 'sk-...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95"
            @click="saveApiKey('openai')"
        >
        Save
        </button>
        </div>
    </div>

    <hr class="border-t border-[var(--glass-border)] opacity-50" />

    <h3 class="text-[14px] font-semibold text-[var(--text-secondary)]">Search & Extract</h3>

    <!-- Web Search Provider -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">Web Search Provider</label>
        <div class="relative">
        <select
            x-model="settings.webSearchProvider"
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <option value="tavily">Tavily</option>
        <option value="brave">Brave Search</option>
        <option value="parallel">Parallel AI</option>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
    </div>

    <!-- URL Extract Provider -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">URL Extract Provider</label>
        <div class="relative">
        <select
            x-model="settings.urlExtractProvider"
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <option value="auto">Auto (Parallel if key set, else local)</option>
        <option value="parallel">Parallel AI</option>
        <option value="local">Local (httpx + html2text)</option>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
    </div>

    <!-- Tavily API Key -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Tavily API Key</label>
            <span x-show="hasTavilyKey" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.tavily"
            :placeholder="hasTavilyKey ? '••••••••••••••••' : 'tvly-...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95"
            @click="saveApiKey('tavily')"
        >
        Save
        </button>
        </div>
    </div>

    <!-- Brave Search API Key -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Brave Search API Key</label>
            <span x-show="hasBraveKey" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.brave"
            :placeholder="hasBraveKey ? '••••••••••••••••' : 'BSA...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95"
            @click="saveApiKey('brave')"
        >
        Save
        </button>
        </div>
    </div>

    <!-- Parallel AI API Key -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Parallel AI API Key</label>
            <span x-show="hasParallelKey" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.parallel"
            :placeholder="hasParallelKey ? '••••••••••••••••' : 'par-...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95"
            @click="saveApiKey('parallel')"
        >
        Save
        </button>
        </div>
        <small class="text-white/40 text-xs">Used by both web search (parallel provider) and URL extract</small>
    </div>

    <hr class="border-t border-[var(--glass-border)] opacity-50" />

    <h3 class="text-[14px] font-semibold text-[var(--text-secondary)]">Integrations</h3>

    <!-- TTS Provider -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">TTS Provider</label>
        <div class="relative">
        <select
            x-model="settings.ttsProvider"
            @change="saveSettings()"
            class="w-full appearance-none bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-3 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all"
        >
        <option value="openai">OpenAI</option>
        <option value="elevenlabs">ElevenLabs</option>
        </select>
        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-50">
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
        </div>
        </div>
    </div>

    <!-- TTS Voice -->
    <div class="flex flex-col gap-2">
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">TTS Voice</label>
        <input
            type="text"
            x-model="settings.ttsVoice"
            @change="saveSettings()"
            placeholder="alloy"
            class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <small class="text-white/40 text-xs">OpenAI: alloy/echo/fable/onyx/nova/shimmer</small>
    </div>

    <!-- ElevenLabs API Key -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">ElevenLabs API Key</label>
            <span x-show="hasElevenlabsKey" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.elevenlabs"
            :placeholder="hasElevenlabsKey ? '••••••••••••••••' : 'xi-...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95"
            @click="saveApiKey('elevenlabs')"
        >
        Save
        </button>
        </div>
    </div>

    <!-- Google OAuth Client ID -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Google OAuth Client ID</label>
            <span x-show="hasGoogleOAuthId" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.google_oauth_id"
            :placeholder="hasGoogleOAuthId ? '••••••••••••••••' : 'client-id...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95"
            @click="saveApiKey('google_oauth_id')"
        >
        Save
        </button>
        </div>
    </div>

    <!-- Google OAuth Client Secret -->
    <div class="flex flex-col gap-2">
        <div class="flex justify-between items-center">
            <label class="text-[13px] font-medium text-[var(--text-secondary)]">Google OAuth Client Secret</label>
            <span x-show="hasGoogleOAuthSecret" class="text-xs font-medium text-[var(--success-color)] flex items-center gap-1">
                <i data-lucide="check" class="w-3 h-3"></i> Saved
            </span>
        </div>
        <div class="flex gap-2">
        <input
            type="password"
            x-model="apiKeys.google_oauth_secret"
            :placeholder="hasGoogleOAuthSecret ? '••••••••••••••••' : 'client-secret...'"
            class="flex-1 bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <button
            class="bg-[var(--accent-color)] hover:bg-[var(--accent-hover)] text-white px-4 py-2 rounded-[8px] text-[13px] font-semibold transition-all active:scale-95"
            @click="saveApiKey('google_oauth_secret')"
        >
        Save
        </button>
        </div>
    </div>

    <hr class="border-t border-[var(--glass-border)] opacity-50" />

    <h3 class="text-[14px] font-semibold text-[var(--text-secondary)]">Maintenance</h3>

    <!-- Self-Audit Daemon -->
    <div class="flex flex-col gap-2">
        <label class="flex items-start gap-3 cursor-pointer group">
        <input type="checkbox" x-model="settings.selfAuditEnabled" @change="saveSettings()" class="mt-0.5 accent-[var(--accent-color)] w-4 h-4">
        <div class="flex flex-col">
            <span class="text-[14px] font-medium group-hover:text-white transition-colors">Self-Audit Daemon</span>
            <span class="text-xs text-white/40 mt-0.5">Run automated security and health checks on a schedule</span>
        </div>
        </label>
    </div>

    <!-- Self-Audit Schedule (shown when enabled) -->
    <div class="flex flex-col gap-2 pl-7" x-show="settings.selfAuditEnabled" x-transition>
        <label class="text-[13px] font-medium text-[var(--text-secondary)]">Schedule (cron)</label>
        <input
            type="text"
            x-model="settings.selfAuditSchedule"
            @change="saveSettings()"
            placeholder="0 3 * * *"
            class="w-full bg-black/30 border border-[var(--glass-border)] rounded-[10px] py-2.5 px-3.5 text-[14px] text-white focus:outline-none focus:border-[var(--accent-color)] focus:bg-black/40 transition-all placeholder-white/20"
        />
        <small class="text-white/40 text-xs">Cron expression (default: 3 AM daily)</small>
    </div>
    </div>
</div>
</div>
